# devops-netology  
Home work 10-monitoring-06-incident-management
# Домашнее задание к занятию "10.06. Инцидент-менеджмент"

## Задание 1

Составьте постмотрем, на основе реального сбоя системы Github в 2018 году.

Информация о сбое доступна [в виде краткой выжимки на русском языке](https://habr.com/ru/post/427301/) , а
также [развёрнуто на английском языке](https://github.blog/2018-10-30-oct21-post-incident-analysis/).

# 10-06-monitoring-incident-management

|           |        | 
| ------------- |:-------------| 
| Краткое описание инцидента      | Выдача неконсистентных данных сервисом в течении 24 часа 11 минут, были затронуты в т.ч. работа webhook и части внутренних процессов. Начало инцидента зафиксировано как 2018 21 октября 22:52 UTC.|
| Предшествующие события      | Замена оптического оборудования 100Gbit/sec по причине выхода из строя      |
| Причина инцидента | Нарушение сетевой связности между сетевыми центром на восточном побережье США и основным ЦОД на восточном побережье США привело к обработке Orchestrator этого события. Кворум был установлен и операции записи направлены в центр обработки данных на западном побережье США.  |
| Воздействие  | Серверы в ЦОД на восточном побережье США получили короткий период, в течение которого записи не были реплицирован в ЦОД на западном побережье США. Оба ЦОД (западное и восточное побережье) получили записи, не содержащиеся в другом ЦОД, безопасный возврат к исходной топологии не мог быть осуществлен автоматически|
| Обнаружение | 2018 21 октября 22:54 UTC мониторинг начал выдавать предупреждения о многочисленных сбоях в работе систем. В это время несколько инженеров отвечали и работали над сортировкой входящих уведомлений. К 23:02 UTC инженеры первой линии реагирования определили, что топологии кластеров БД перешли в непредвиденный статус.    |
| Реакция  | 2018 21 октября 23:19 UTC Опрос состояния кластеров БД показал, что необходимо остановить выполнение заданий, записывающих определенные метаданные. При реализации преимущество было отдано целостности данных, а не другим критериям     |
| Восстановление  | Использовать резервные копии, провести синхронизацию реплик в обоих ЦОД, вернуться к штатной топологии, а затем приступить к обработке заданий в очереди     |
| Таймлайн  |
|2018 21 октября 22:52 UTC | Потеря сетевой связности, перенаправление Оркестратором операции записи в ЦОД Западного побережья 
|2018 21 октября 22:54 UTC | Начало генерации мониторингом предупреждений о многочисленных сбоях в системах 
|2018 21 октября 23:02 UTC | инженеры первой линии реагирования определяют, что топологии кластеров БД находятся в непредвиденном статусе
|2018 21 октября 23:07 UTC | Вручную устанавливается блокировка внесения каких-либо дополнительных изменений в конфигурацию систем.
|2018 21 октября 23:09 UTC | Состояние сайта переводится в жёлтый статус, с экалацией координатору.
|2018 21 октября 23:13 UTC | Координатор переводит сайт красный статус, стартует работа по переводу операций записи в ЦОД Восточного побережья
|2018 21 октября 23:19 UTC | Отключение записи метаданных событий и прочего, влияющего на удобство сайта, чтобы сохранить пользовательские данные. 
|2018 22 октября 00:05 UTC | Разработка плана восстановления
|2018 22 октября 00:41 UTC | Старт процесса восстановления резервных копий для всех затронутых БД
|2018 22 октября 06:51 UTC | Частичное завершение восстановления копий в ЦОД  восточного побережья США и начало репликацию в ЦОД западного побережья
|2018 22 октября 07:46 UTC | Публикация информации об инциденте
|2018 22 октября 11:12 UTC | Все primary-БД установлены на восточном побережье США, но из-за начала рабочего дня и увеличения нагрузки восстановление заняло больше времени, чем ожидалось. 
|2018 22 октября 13:15 UTC | Уменьшение нагрузки чтения за счет увеличения доступных реплик позволило репликации "догнать" необходимое состояние. 
|2018 22 октября 16:24 UTC | Реплики синхронизированы.
|2018 22 октября 16:45 UTC | Начато выполнение отложенных действий (webhook и прочее)
|2018 22 октября 23:03 UTC | Все отложенные действия завершены, сайт переведён в зелёный статус
| Последующие действия |Перенастройка конфигурации Orchestrator в части более безопасной работы при изменении топологии и сопуствующие меры.
